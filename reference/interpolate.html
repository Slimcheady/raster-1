<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Interpolate — interpolate • raster</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Interpolate — interpolate" />
<meta property="og:description" content="Make a RasterLayer with interpolated values using a fitted model object of classes such as 'gstat' (gstat package) or 'Krige' (fields package). That is, these are models that have location ('x' and 'y', or 'longitude' and 'latitude') as independent variables. If x and y are the only independent variables provide an empty (no associated data in memory or on file) RasterLayer for which you want predictions. If there are more spatial predictor variables provide these as a Raster* object in the first argument of the function. If you do not have x and y locations as implicit predictors in your model you should use predict instead." />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">raster</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">3.4-14</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/rspatial/raster/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Interpolate</h1>
    
    <div class="hidden name"><code>interpolate.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Make a RasterLayer with interpolated values using a fitted model object of classes such as 'gstat' (gstat package) or 'Krige' (fields package). That is, these are models that have location ('x' and 'y', or 'longitude' and 'latitude') as independent variables. If x and y are the only independent variables provide an empty (no associated data in memory or on file) RasterLayer for which you want predictions. If there are more spatial predictor variables provide these as a Raster* object in the first argument of the function. If you do not have x and y locations as implicit predictors in your model you should use <code><a href='predict.html'>predict</a></code> instead.</p>
    </div>

    <pre class="usage"><span class='co'># S4 method for Raster</span>
<span class='fu'>interpolate</span><span class='op'>(</span><span class='va'>object</span>, <span class='va'>model</span>, filename<span class='op'>=</span><span class='st'>""</span>, fun<span class='op'>=</span><span class='va'>predict</span>, xyOnly<span class='op'>=</span><span class='cn'>TRUE</span>,
   xyNames<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>'x'</span>, <span class='st'>'y'</span><span class='op'>)</span>, ext<span class='op'>=</span><span class='cn'>NULL</span>, const<span class='op'>=</span><span class='cn'>NULL</span>, index<span class='op'>=</span><span class='fl'>1</span>, na.rm<span class='op'>=</span><span class='cn'>TRUE</span>, debug.level<span class='op'>=</span><span class='fl'>1</span>, <span class='va'>...</span><span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>object</th>
      <td><p>Raster* object</p></td>
    </tr>
    <tr>
      <th>model</th>
      <td><p>model object</p></td>
    </tr>
    <tr>
      <th>filename</th>
      <td><p>character. Output filename (optional)</p></td>
    </tr>
    <tr>
      <th>fun</th>
      <td><p>function. Default value is 'predict', but can be replaced with e.g. 'predict.se' (depending on the class of the model object)</p></td>
    </tr>
    <tr>
      <th>xyOnly</th>
      <td><p>logical. If <code>TRUE</code>, values of the Raster* object are not considered as co-variables; and only x and y (longitude and latitude) are used. This should match the model</p></td>
    </tr>
    <tr>
      <th>xyNames</th>
      <td><p>character. variable names that the model uses for the spatial coordinates. E.g., <code><a href='https://rdrr.io/r/base/c.html'>c('longitude', 'latitude')</a></code></p></td>
    </tr>
    <tr>
      <th>ext</th>
      <td><p>Extent object to limit the prediction to a sub-region of <code>x</code></p></td>
    </tr>
    <tr>
      <th>const</th>
      <td><p>data.frame. Can be used to add a constant for which there is no Raster object for model predictions. This is particulary useful if the constant is a character-like factor value</p></td>
    </tr>
    <tr>
      <th>index</th>
      <td><p>integer. To select the column if 'predict.model' returns a matrix with multiple columns</p></td>
    </tr>
    <tr>
      <th>na.rm</th>
      <td><p>logical. Remove cells with NA values in the predictors before solving the model (and return <code>NA</code> for those cells). In most cases this will not affect the output. This option prevents errors with models that cannot handle <code>NA</code> values</p></td>
    </tr>
    <tr>
      <th>debug.level</th>
      <td><p>for gstat models only. See ?</p></td>
    </tr>
    <tr>
      <th>...</th>
      <td><p>additional arguments passed to the predict.'model' function</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>Raster* object</p>
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p><code><a href='predict.html'>predict</a></code>, <code><a href='https://rdrr.io/pkg/gstat/man/predict.gstat.html'>predict.gstat</a></code>, <code><a href='https://rdrr.io/pkg/fields/man/Tps.html'>Tps</a></code></p></div>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='co'># \donttest{</span>
<span class='co'>## Thin plate spline interpolation with x and y only</span>
<span class='co'># some example data</span>
<span class='va'>r</span> <span class='op'>&lt;-</span> <span class='fu'><a href='raster.html'>raster</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/system.file.html'>system.file</a></span><span class='op'>(</span><span class='st'>"external/test.grd"</span>, package<span class='op'>=</span><span class='st'>"raster"</span><span class='op'>)</span><span class='op'>)</span>
<span class='va'>ra</span> <span class='op'>&lt;-</span> <span class='fu'><a href='aggregate.html'>aggregate</a></span><span class='op'>(</span><span class='va'>r</span>, <span class='fl'>10</span><span class='op'>)</span>
<span class='va'>xy</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span><span class='op'>(</span><span class='fu'><a href='xyFromCell.html'>xyFromCell</a></span><span class='op'>(</span><span class='va'>ra</span>, <span class='fl'>1</span><span class='op'>:</span><span class='fu'><a href='ncell.html'>ncell</a></span><span class='op'>(</span><span class='va'>ra</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span>
<span class='va'>v</span> <span class='op'>&lt;-</span> <span class='fu'><a href='getValues.html'>getValues</a></span><span class='op'>(</span><span class='va'>ra</span><span class='op'>)</span>
<span class='co'># remove NAs</span>
<span class='va'>i</span> <span class='op'>&lt;-</span> <span class='op'>!</span><span class='fu'><a href='https://rdrr.io/r/base/NA.html'>is.na</a></span><span class='op'>(</span><span class='va'>v</span><span class='op'>)</span>
<span class='va'>xy</span> <span class='op'>&lt;-</span> <span class='va'>xy</span><span class='op'>[</span><span class='va'>i</span>,<span class='op'>]</span>
<span class='va'>v</span> <span class='op'>&lt;-</span> <span class='va'>v</span><span class='op'>[</span><span class='va'>i</span><span class='op'>]</span>

<span class='co'>#### Thin plate spline model</span>
<span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://github.com/NCAR/Fields'>fields</a></span><span class='op'>)</span> 
</div><div class='output co'>#&gt; <span class='message'>Loading required package: spam</span></div><div class='output co'>#&gt; <span class='message'>Loading required package: dotCall64</span></div><div class='output co'>#&gt; <span class='message'>Loading required package: grid</span></div><div class='output co'>#&gt; <span class='message'>Spam version 2.7-0 (2021-06-25) is loaded.</span>
#&gt; <span class='message'>Type 'help( Spam)' or 'demo( spam)' for a short introduction </span>
#&gt; <span class='message'>and overview of this package.</span>
#&gt; <span class='message'>Help for individual functions is also obtained by adding the</span>
#&gt; <span class='message'>suffix '.spam' to the function name, e.g. 'help( chol.spam)'.</span></div><div class='output co'>#&gt; <span class='message'></span>
#&gt; <span class='message'>Attaching package: ‘spam’</span></div><div class='output co'>#&gt; <span class='message'>The following objects are masked from ‘package:base’:</span>
#&gt; <span class='message'></span>
#&gt; <span class='message'>    backsolve, forwardsolve</span></div><div class='output co'>#&gt; <span class='message'>Loading required package: viridis</span></div><div class='output co'>#&gt; <span class='message'>Loading required package: viridisLite</span></div><div class='output co'>#&gt; <span class='message'>See https://github.com/NCAR/Fields for</span>
#&gt; <span class='message'> an extensive vignette, other supplements and source code </span></div><div class='input'><span class='va'>tps</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/fields/man/Tps.html'>Tps</a></span><span class='op'>(</span><span class='va'>xy</span>, <span class='va'>v</span><span class='op'>)</span>
</div><div class='output co'>#&gt; Warning: 
#&gt; Grid searches over lambda (nugget and sill variances) with  minima at the endpoints: 
#&gt;   (GCV) Generalized Cross-Validation 
#&gt;    minimum at  right endpoint  lambda  =  2.375093e-05 (eff. df= 46.55 )</div><div class='input'><span class='va'>p</span> <span class='op'>&lt;-</span> <span class='fu'><a href='raster.html'>raster</a></span><span class='op'>(</span><span class='va'>r</span><span class='op'>)</span>

<span class='co'># use model to predict values at all locations</span>
<span class='va'>p</span> <span class='op'>&lt;-</span> <span class='fu'>interpolate</span><span class='op'>(</span><span class='va'>p</span>, <span class='va'>tps</span><span class='op'>)</span>
<span class='va'>p</span> <span class='op'>&lt;-</span> <span class='fu'><a href='mask.html'>mask</a></span><span class='op'>(</span><span class='va'>p</span>, <span class='va'>r</span><span class='op'>)</span>

<span class='fu'><a href='plot.html'>plot</a></span><span class='op'>(</span><span class='va'>p</span><span class='op'>)</span>
</div><div class='img'><img src='interpolate-1.png' alt='' width='700' height='433' /></div><div class='input'><span class='co'>## change the fun from predict to fields::predictSE to get the TPS standard error</span>
<span class='va'>se</span> <span class='op'>&lt;-</span> <span class='fu'>interpolate</span><span class='op'>(</span><span class='va'>p</span>, <span class='va'>tps</span>, fun<span class='op'>=</span><span class='va'>predictSE</span><span class='op'>)</span>
<span class='va'>se</span> <span class='op'>&lt;-</span> <span class='fu'><a href='mask.html'>mask</a></span><span class='op'>(</span><span class='va'>se</span>, <span class='va'>r</span><span class='op'>)</span>
<span class='fu'><a href='plot.html'>plot</a></span><span class='op'>(</span><span class='va'>se</span><span class='op'>)</span>
</div><div class='img'><img src='interpolate-2.png' alt='' width='700' height='433' /></div><div class='input'>
<span class='co'>## another variable; let's call it elevation</span>
<span class='va'>elevation</span> <span class='op'>&lt;-</span> <span class='op'>(</span><span class='fu'><a href='initialize.html'>init</a></span><span class='op'>(</span><span class='va'>r</span>, <span class='st'>'x'</span><span class='op'>)</span> <span class='op'>*</span> <span class='fu'><a href='initialize.html'>init</a></span><span class='op'>(</span><span class='va'>r</span>, <span class='st'>'y'</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>/</span> <span class='fl'>100000000</span>
<span class='fu'><a href='names.html'>names</a></span><span class='op'>(</span><span class='va'>elevation</span><span class='op'>)</span> <span class='op'>&lt;-</span> <span class='st'>'elev'</span>

<span class='va'>z</span> <span class='op'>&lt;-</span> <span class='fu'><a href='extract.html'>extract</a></span><span class='op'>(</span><span class='va'>elevation</span>, <span class='va'>xy</span><span class='op'>)</span>

<span class='co'># add as another independent variable</span>
<span class='va'>xyz</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/cbind.html'>cbind</a></span><span class='op'>(</span><span class='va'>xy</span>, <span class='va'>z</span><span class='op'>)</span>
<span class='va'>tps2</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/fields/man/Tps.html'>Tps</a></span><span class='op'>(</span><span class='va'>xyz</span>, <span class='va'>v</span><span class='op'>)</span>
</div><div class='output co'>#&gt; Warning: 
#&gt; Grid searches over lambda (nugget and sill variances) with  minima at the endpoints: 
#&gt;   (GCV) Generalized Cross-Validation 
#&gt;    minimum at  right endpoint  lambda  =  0.0002279721 (eff. df= 46.55 )</div><div class='input'><span class='va'>p2</span> <span class='op'>&lt;-</span> <span class='fu'>interpolate</span><span class='op'>(</span><span class='va'>elevation</span>, <span class='va'>tps2</span>, xyOnly<span class='op'>=</span><span class='cn'>FALSE</span><span class='op'>)</span>

<span class='co'># as a linear coveriate</span>
<span class='va'>tps3</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/fields/man/Tps.html'>Tps</a></span><span class='op'>(</span><span class='va'>xy</span>, <span class='va'>v</span>, Z<span class='op'>=</span><span class='va'>z</span><span class='op'>)</span>
</div><div class='output co'>#&gt; Warning: 
#&gt; Grid searches over lambda (nugget and sill variances) with  minima at the endpoints: 
#&gt;   (GCV) Generalized Cross-Validation 
#&gt;    minimum at  right endpoint  lambda  =  2.427486e-05 (eff. df= 46.54999 )</div><div class='input'>
<span class='co'># Z is a separate argument in Krig.predict, so we need a new function</span>
<span class='co'># Internally (in interpolate) a matrix is formed of x, y, and elev (Z)</span>

<span class='va'>pfun</span> <span class='op'>&lt;-</span> <span class='kw'>function</span><span class='op'>(</span><span class='va'>model</span>, <span class='va'>x</span>, <span class='va'>...</span><span class='op'>)</span> <span class='op'>{</span>
   <span class='fu'><a href='predict.html'>predict</a></span><span class='op'>(</span><span class='va'>model</span>, <span class='va'>x</span><span class='op'>[</span>,<span class='fl'>1</span><span class='op'>:</span><span class='fl'>2</span><span class='op'>]</span>, Z<span class='op'>=</span><span class='va'>x</span><span class='op'>[</span>,<span class='fl'>3</span><span class='op'>]</span>, <span class='va'>...</span><span class='op'>)</span>
<span class='op'>}</span>
<span class='va'>p3</span> <span class='op'>&lt;-</span> <span class='fu'>interpolate</span><span class='op'>(</span><span class='va'>elevation</span>, <span class='va'>tps3</span>, xyOnly<span class='op'>=</span><span class='cn'>FALSE</span>, fun<span class='op'>=</span><span class='va'>pfun</span><span class='op'>)</span>

<span class='co'>#### gstat examples</span>
<span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://github.com/r-spatial/gstat/'>gstat</a></span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/utils/data.html'>data</a></span><span class='op'>(</span><span class='va'>meuse</span><span class='op'>)</span>

<span class='co'>## inverse distance weighted (IDW)</span>
<span class='va'>r</span> <span class='op'>&lt;-</span> <span class='fu'><a href='raster.html'>raster</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/system.file.html'>system.file</a></span><span class='op'>(</span><span class='st'>"external/test.grd"</span>, package<span class='op'>=</span><span class='st'>"raster"</span><span class='op'>)</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/utils/data.html'>data</a></span><span class='op'>(</span><span class='va'>meuse</span><span class='op'>)</span>
<span class='va'>mg</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/gstat/man/gstat.html'>gstat</a></span><span class='op'>(</span>id <span class='op'>=</span> <span class='st'>"zinc"</span>, formula <span class='op'>=</span> <span class='va'>zinc</span><span class='op'>~</span><span class='fl'>1</span>, locations <span class='op'>=</span> <span class='op'>~</span><span class='va'>x</span><span class='op'>+</span><span class='va'>y</span>, data<span class='op'>=</span><span class='va'>meuse</span>, 
            nmax<span class='op'>=</span><span class='fl'>7</span>, set<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>idp <span class='op'>=</span> <span class='fl'>.5</span><span class='op'>)</span><span class='op'>)</span>
<span class='va'>z</span> <span class='op'>&lt;-</span> <span class='fu'>interpolate</span><span class='op'>(</span><span class='va'>r</span>, <span class='va'>mg</span><span class='op'>)</span>
</div><div class='output co'>#&gt; [inverse distance weighted interpolation]</div><div class='input'><span class='va'>z</span> <span class='op'>&lt;-</span> <span class='fu'><a href='mask.html'>mask</a></span><span class='op'>(</span><span class='va'>z</span>, <span class='va'>r</span><span class='op'>)</span>

<span class='co'>## kriging</span>
<span class='fu'><a href='xyFromCell.html'>coordinates</a></span><span class='op'>(</span><span class='va'>meuse</span><span class='op'>)</span> <span class='op'>&lt;-</span> <span class='op'>~</span><span class='va'>x</span><span class='op'>+</span><span class='va'>y</span>
<span class='fu'><a href='projection.html'>crs</a></span><span class='op'>(</span><span class='va'>meuse</span><span class='op'>)</span> <span class='op'>&lt;-</span> <span class='fu'><a href='projection.html'>crs</a></span><span class='op'>(</span><span class='va'>r</span><span class='op'>)</span>

<span class='co'>## ordinary kriging</span>
<span class='va'>v</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/gstat/man/variogram.html'>variogram</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/Log.html'>log</a></span><span class='op'>(</span><span class='va'>zinc</span><span class='op'>)</span><span class='op'>~</span><span class='fl'>1</span>, <span class='va'>meuse</span><span class='op'>)</span>
<span class='va'>m</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/gstat/man/fit.variogram.html'>fit.variogram</a></span><span class='op'>(</span><span class='va'>v</span>, <span class='fu'><a href='https://rdrr.io/pkg/gstat/man/vgm.html'>vgm</a></span><span class='op'>(</span><span class='fl'>1</span>, <span class='st'>"Sph"</span>, <span class='fl'>300</span>, <span class='fl'>1</span><span class='op'>)</span><span class='op'>)</span>
<span class='va'>gOK</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/gstat/man/gstat.html'>gstat</a></span><span class='op'>(</span><span class='cn'>NULL</span>, <span class='st'>"log.zinc"</span>, <span class='fu'><a href='https://rdrr.io/r/base/Log.html'>log</a></span><span class='op'>(</span><span class='va'>zinc</span><span class='op'>)</span><span class='op'>~</span><span class='fl'>1</span>, <span class='va'>meuse</span>, model<span class='op'>=</span><span class='va'>m</span><span class='op'>)</span>
<span class='va'>OK</span> <span class='op'>&lt;-</span> <span class='fu'>interpolate</span><span class='op'>(</span><span class='va'>r</span>, <span class='va'>gOK</span><span class='op'>)</span>
</div><div class='output co'>#&gt; [using ordinary kriging]</div><div class='input'>
<span class='co'># examples below provided by Maurizio Marchi</span>
<span class='co'>## universial kriging</span>
<span class='va'>vu</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/gstat/man/variogram.html'>variogram</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/Log.html'>log</a></span><span class='op'>(</span><span class='va'>zinc</span><span class='op'>)</span><span class='op'>~</span><span class='va'>elev</span>, <span class='va'>meuse</span><span class='op'>)</span>
<span class='va'>mu</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/gstat/man/fit.variogram.html'>fit.variogram</a></span><span class='op'>(</span><span class='va'>vu</span>, <span class='fu'><a href='https://rdrr.io/pkg/gstat/man/vgm.html'>vgm</a></span><span class='op'>(</span><span class='fl'>1</span>, <span class='st'>"Sph"</span>, <span class='fl'>300</span>, <span class='fl'>1</span><span class='op'>)</span><span class='op'>)</span>
<span class='va'>gUK</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/gstat/man/gstat.html'>gstat</a></span><span class='op'>(</span><span class='cn'>NULL</span>, <span class='st'>"log.zinc"</span>, <span class='fu'><a href='https://rdrr.io/r/base/Log.html'>log</a></span><span class='op'>(</span><span class='va'>zinc</span><span class='op'>)</span><span class='op'>~</span><span class='va'>elev</span>, <span class='va'>meuse</span>, model<span class='op'>=</span><span class='va'>mu</span><span class='op'>)</span>
<span class='fu'><a href='names.html'>names</a></span><span class='op'>(</span><span class='va'>r</span><span class='op'>)</span> <span class='op'>&lt;-</span> <span class='st'>'elev'</span>
<span class='va'>UK</span> <span class='op'>&lt;-</span> <span class='fu'>interpolate</span><span class='op'>(</span><span class='va'>r</span>, <span class='va'>gUK</span>, xyOnly<span class='op'>=</span><span class='cn'>FALSE</span><span class='op'>)</span>
</div><div class='output co'>#&gt; [using universal kriging]</div><div class='input'>
<span class='co'>## co-kriging</span>
<span class='va'>gCoK</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/gstat/man/gstat.html'>gstat</a></span><span class='op'>(</span><span class='cn'>NULL</span>, <span class='st'>'log.zinc'</span>, <span class='fu'><a href='https://rdrr.io/r/base/Log.html'>log</a></span><span class='op'>(</span><span class='va'>zinc</span><span class='op'>)</span><span class='op'>~</span><span class='fl'>1</span>, <span class='va'>meuse</span><span class='op'>)</span>
<span class='va'>gCoK</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/gstat/man/gstat.html'>gstat</a></span><span class='op'>(</span><span class='va'>gCoK</span>, <span class='st'>'elev'</span>, <span class='va'>elev</span><span class='op'>~</span><span class='fl'>1</span>, <span class='va'>meuse</span><span class='op'>)</span>
<span class='va'>gCoK</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/gstat/man/gstat.html'>gstat</a></span><span class='op'>(</span><span class='va'>gCoK</span>, <span class='st'>'cadmium'</span>, <span class='va'>cadmium</span><span class='op'>~</span><span class='fl'>1</span>, <span class='va'>meuse</span><span class='op'>)</span>
<span class='va'>gCoK</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/gstat/man/gstat.html'>gstat</a></span><span class='op'>(</span><span class='va'>gCoK</span>, <span class='st'>'copper'</span>, <span class='va'>copper</span><span class='op'>~</span><span class='fl'>1</span>, <span class='va'>meuse</span><span class='op'>)</span>
<span class='va'>coV</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/gstat/man/variogram.html'>variogram</a></span><span class='op'>(</span><span class='va'>gCoK</span><span class='op'>)</span>
<span class='fu'><a href='plot.html'>plot</a></span><span class='op'>(</span><span class='va'>coV</span>, type<span class='op'>=</span><span class='st'>'b'</span>, main<span class='op'>=</span><span class='st'>'Co-variogram'</span><span class='op'>)</span>
</div><div class='img'><img src='interpolate-3.png' alt='' width='700' height='433' /></div><div class='input'><span class='va'>coV.fit</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/gstat/man/fit.lmc.html'>fit.lmc</a></span><span class='op'>(</span><span class='va'>coV</span>, <span class='va'>gCoK</span>, <span class='fu'><a href='https://rdrr.io/pkg/gstat/man/vgm.html'>vgm</a></span><span class='op'>(</span>model<span class='op'>=</span><span class='st'>'Sph'</span>, range<span class='op'>=</span><span class='fl'>1000</span><span class='op'>)</span><span class='op'>)</span>
<span class='va'>coV.fit</span>
</div><div class='output co'>#&gt; data:
#&gt; log.zinc : formula = log(zinc)`~`1 ; data dim = 155 x 12
#&gt; elev : formula = elev`~`1 ; data dim = 155 x 12
#&gt; cadmium : formula = cadmium`~`1 ; data dim = 155 x 12
#&gt; copper : formula = copper`~`1 ; data dim = 155 x 12
#&gt; variograms:
#&gt;                  model       psill range
#&gt; log.zinc           Sph   0.7132435  1000
#&gt; elev               Sph   1.6908552  1000
#&gt; cadmium            Sph  17.4957356  1000
#&gt; copper             Sph 809.4027563  1000
#&gt; log.zinc.elev      Sph  -0.7404289  1000
#&gt; log.zinc.cadmium   Sph   2.9802854  1000
#&gt; elev.cadmium       Sph  -3.2983554  1000
#&gt; log.zinc.copper    Sph  20.4199742  1000
#&gt; elev.copper        Sph -22.4955673  1000
#&gt; cadmium.copper     Sph 111.1393673  1000</div><div class='input'><span class='fu'><a href='plot.html'>plot</a></span><span class='op'>(</span><span class='va'>coV</span>, <span class='va'>coV.fit</span>, main<span class='op'>=</span><span class='st'>'Fitted Co-variogram'</span><span class='op'>)</span>
</div><div class='img'><img src='interpolate-4.png' alt='' width='700' height='433' /></div><div class='input'><span class='va'>coK</span> <span class='op'>&lt;-</span> <span class='fu'>interpolate</span><span class='op'>(</span><span class='va'>r</span>, <span class='va'>coV.fit</span><span class='op'>)</span>
</div><div class='output co'>#&gt; Intrinsic Correlation found. Good.
#&gt; [using ordinary cokriging]</div><div class='input'><span class='fu'><a href='plot.html'>plot</a></span><span class='op'>(</span><span class='va'>coK</span><span class='op'>)</span>
</div><div class='img'><img src='interpolate-5.png' alt='' width='700' height='433' /></div><div class='input'><span class='co'># }</span>
</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Robert J. Hijmans.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


